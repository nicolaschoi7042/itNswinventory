<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Roboe Technology inc IT 자산 및 SW 인벤토리 관리시스템</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <header class="header">
            <h1><i class="fas fa-laptop"></i> Roboe Technology inc IT 자산 및 SW 인벤토리 관리시스템</h1>
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-number" id="totalEmployees">0</span>
                    <span class="stat-label">임직원</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="totalAssets">0</span>
                    <span class="stat-label">하드웨어 자산</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="totalSoftware">0</span>
                    <span class="stat-label">소프트웨어</span>
                </div>
            </div>
        </header>

        <!-- 네비게이션 탭 -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="dashboard">
                <i class="fas fa-chart-dashboard"></i> 대시보드
            </button>
            <button class="nav-tab" data-tab="employees">
                <i class="fas fa-users"></i> 임직원 관리
            </button>
            <button class="nav-tab" data-tab="hardware">
                <i class="fas fa-desktop"></i> 하드웨어 자산
            </button>
            <button class="nav-tab" data-tab="software">
                <i class="fas fa-compact-disc"></i> 소프트웨어
            </button>
            <button class="nav-tab" data-tab="assignment">
                <i class="fas fa-exchange-alt"></i> 자산 할당
            </button>
        </nav>

        <!-- 대시보드 탭 -->
        <div id="dashboard" class="tab-content active">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>자산 현황</h3>
                    <canvas id="assetChart" width="300" height="200"></canvas>
                </div>
                <div class="dashboard-card">
                    <h3>소프트웨어 라이선스</h3>
                    <div id="licenseStatus">
                        <div class="license-item">
                            <span>Microsoft Office: <strong id="officeCount">0</strong>개</span>
                        </div>
                        <div class="license-item">
                            <span>Windows: <strong id="windowsCount">0</strong>개</span>
                        </div>
                        <div class="license-item">
                            <span>Adobe Creative: <strong id="adobeCount">0</strong>개</span>
                        </div>
                    </div>
                </div>
                <div class="dashboard-card">
                    <h3>최근 활동</h3>
                    <div id="recentActivities"></div>
                </div>
            </div>
            
            <!-- SW 라이선스 점검 매뉴얼 섹션 -->
            <div class="dashboard-manual-section">
                <div class="section-header">
                    <h2>SW 라이선스 점검 매뉴얼</h2>
                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="openPdfInNewTab()">
                            <i class="fas fa-external-link-alt"></i> 새 창에서 열기
                        </button>
                        <button class="btn btn-secondary" onclick="downloadPdf()">
                            <i class="fas fa-download"></i> PDF 다운로드
                        </button>
                    </div>
                </div>

                <div class="manual-container">
                    <div class="manual-description">
                        <h3><i class="fas fa-info-circle"></i> 소프트웨어 라이선스 개별 점검 가이드</h3>
                        <p>이 매뉴얼은 직원들이 개별적으로 자신의 PC에 설치된 소프트웨어의 라이선스를 점검할 수 있도록 도와주는 가이드입니다.</p>
                        <ul>
                            <li>SMART Check Plus 프로그램 사용법</li>
                            <li>소프트웨어 라이선스 확인 절차</li>
                            <li>점검 결과 해석 및 조치사항</li>
                            <li>문제 발생 시 대응 방법</li>
                        </ul>
                    </div>

                    <!-- PDF 뷰어 -->
                    <div class="pdf-viewer-container">
                        <div class="pdf-viewer-tabs">
                            <button class="pdf-tab active" onclick="showPdfEmbed()">
                                <i class="fas fa-file-pdf"></i> 내장 뷰어
                            </button>
                            <button class="pdf-tab" onclick="showPdfObject()">
                                <i class="fas fa-window-restore"></i> 브라우저 뷰어
                            </button>
                        </div>

                        <!-- 내장 iframe 뷰어 -->
                        <div id="embedViewer" class="pdf-viewer">
                            <iframe id="pdfViewer"
                                    src="SMART_Check_Plus_User_Manual_V2.0.pdf#toolbar=1&navpanes=1&scrollbar=1"
                                    width="100%"
                                    height="700px"
                                    frameborder="0"
                                    scrolling="auto">
                                <p>PDF를 표시할 수 없습니다.
                                   <a href="SMART_Check_Plus_User_Manual_V2.0.pdf" target="_blank">여기를 클릭하여 PDF를 다운로드하세요.</a>
                                </p>
                            </iframe>
                        </div>

                        <!-- 브라우저 object 뷰어 -->
                        <div id="objectViewer" class="pdf-viewer" style="display: none;">
                            <object data="SMART_Check_Plus_User_Manual_V2.0.pdf#toolbar=1&navpanes=1&scrollbar=1"
                                    type="application/pdf"
                                    width="100%"
                                    height="700px">
                                <p>PDF를 표시할 수 없습니다.
                                   <a href="SMART_Check_Plus_User_Manual_V2.0.pdf" target="_blank">여기를 클릭하여 PDF를 다운로드하세요.</a>
                                </p>
                            </object>
                        </div>

                        <!-- PDF 뷰어 안내 -->
                        <div class="pdf-viewer-help">
                            <p><i class="fas fa-info-circle"></i>
                               <strong>스크롤이 안되는 경우:</strong>
                               "브라우저 뷰어" 탭을 클릭하거나 "새 창에서 열기" 버튼을 사용하세요.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 임직원 관리 탭 -->
        <div id="employees" class="tab-content">
            <div class="section-header">
                <h2>임직원 관리</h2>
                <div class="section-actions">
                    <button class="btn btn-success" onclick="exportToExcel('employees')">
                        <i class="fas fa-file-excel"></i> 엑셀 내보내기
                    </button>
                    <button class="btn btn-primary" onclick="showEmployeeModal()">
                        <i class="fas fa-plus"></i> 신규 등록
                    </button>
                </div>
            </div>
            <div class="search-filter">
                <input type="text" id="employeeSearch" placeholder="이름, 부서, 사번으로 검색..." class="search-input">
                <select id="departmentFilter" class="filter-select">
                    <option value="">전체 부서</option>
                    <option value="개발팀">개발팀</option>
                    <option value="영업팀">영업팀</option>
                    <option value="인사팀">인사팀</option>
                    <option value="재무팀">재무팀</option>
                </select>
            </div>
            <div class="table-container">
                <table id="employeeTable">
                    <thead>
                        <tr>
                            <th>사번</th>
                            <th>이름</th>
                            <th>부서</th>
                            <th>할당된 자산</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- 하드웨어 자산 탭 -->
        <div id="hardware" class="tab-content">
            <div class="section-header">
                <h2>하드웨어 자산 관리</h2>
                <div class="section-actions">
                    <button class="btn btn-success" onclick="exportToExcel('hardware')">
                        <i class="fas fa-file-excel"></i> 엑셀 내보내기
                    </button>
                    <button class="btn btn-primary" onclick="showHardwareModal()">
                        <i class="fas fa-plus"></i> 자산 등록
                    </button>
                </div>
            </div>
            <div class="search-filter">
                <input type="text" id="hardwareSearch" placeholder="자산태그, 모델명으로 검색..." class="search-input">
                <select id="assetTypeFilter" class="filter-select">
                    <option value="">전체 유형</option>
                    <option value="데스크톱">데스크톱</option>
                    <option value="노트북">노트북</option>
                    <option value="모니터">모니터</option>
                    <option value="프린터">프린터</option>
                    <option value="네트워크장비">네트워크장비</option>
                    <option value="서버">서버</option>
                </select>
                <select id="statusFilter" class="filter-select">
                    <option value="">전체 상태</option>
                    <option value="사용중">사용중</option>
                    <option value="대기중">대기중</option>
                    <option value="수리중">수리중</option>
                    <option value="폐기">폐기</option>
                </select>
            </div>
            <div class="table-container">
                <table id="hardwareTable">
                    <thead>
                        <tr>
                            <th>자산태그</th>
                            <th>유형</th>
                            <th>제조사</th>
                            <th>모델명</th>
                            <th>시리얼번호</th>
                            <th>구입일</th>
                            <th>상태</th>
                            <th>할당자</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- 소프트웨어 탭 -->
        <div id="software" class="tab-content">
            <div class="section-header">
                <h2>소프트웨어 인벤토리</h2>
                <div class="section-actions">
                    <button class="btn btn-success" onclick="exportToExcel('software')">
                        <i class="fas fa-file-excel"></i> 엑셀 내보내기
                    </button>
                    <button class="btn btn-primary" onclick="showSoftwareModal()">
                        <i class="fas fa-plus"></i> 소프트웨어 등록
                    </button>
                </div>
            </div>
            <div class="search-filter">
                <input type="text" id="softwareSearch" placeholder="소프트웨어명, 제조사로 검색..." class="search-input">
                <select id="softwareTypeFilter" class="filter-select">
                    <option value="">전체 유형</option>
                    <option value="운영체제">운영체제</option>
                    <option value="오피스">오피스</option>
                    <option value="개발도구">개발도구</option>
                    <option value="보안">보안</option>
                    <option value="기타">기타</option>
                </select>
            </div>
            <div class="table-container">
                <table id="softwareTable">
                    <thead>
                        <tr>
                            <th>소프트웨어명</th>
                            <th>제조사</th>
                            <th>버전</th>
                            <th>유형</th>
                            <th>라이선스 유형</th>
                            <th>총 라이선스</th>
                            <th>사용중</th>
                            <th>남은 라이선스</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>


        <!-- 자산 할당 탭 -->
        <div id="assignment" class="tab-content">
            <div class="section-header">
                <h2>자산 할당 관리</h2>
                <div class="section-actions">
                    <button class="btn btn-success" onclick="exportToExcel('assignments')">
                        <i class="fas fa-file-excel"></i> 엑셀 내보내기
                    </button>
                    <button class="btn btn-primary" onclick="showAssignmentModal()">
                        <i class="fas fa-plus"></i> 자산 할당
                    </button>
                </div>
            </div>
            <div class="search-filter">
                <input type="text" id="assignmentSearch" placeholder="임직원명, 자산태그로 검색..." class="search-input">
            </div>
            <div class="table-container">
                <table id="assignmentTable">
                    <thead>
                        <tr>
                            <th>할당일</th>
                            <th>임직원</th>
                            <th>부서</th>
                            <th>자산유형</th>
                            <th>자산태그</th>
                            <th>모델명</th>
                            <th>상태</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 임직원 모달 -->
    <div id="employeeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>임직원 정보</h3>
                <span class="close" onclick="closeModal('employeeModal')">&times;</span>
            </div>
            <form id="employeeForm">
                <div class="form-group">
                    <label>이름 *</label>
                    <input type="text" id="empName" required>
                </div>
                <div class="form-group">
                    <label>부서 *</label>
                    <select id="empDepartment" required>
                        <option value="">선택하세요</option>
                        <option value="개발팀">개발팀</option>
                        <option value="영업팀">영업팀</option>
                        <option value="인사팀">인사팀</option>
                        <option value="재무팀">재무팀</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>이메일</label>
                    <input type="email" id="empEmail">
                </div>
                <div class="form-group">
                    <label>연락처</label>
                    <input type="tel" id="empPhone">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('employeeModal')">취소</button>
                    <button type="submit" class="btn btn-primary">저장</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 하드웨어 모달 -->
    <div id="hardwareModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>하드웨어 자산 정보</h3>
                <span class="close" onclick="closeModal('hardwareModal')">&times;</span>
            </div>
            <form id="hardwareForm">
                <div class="form-group">
                    <label>자산태그 *</label>
                    <input type="text" id="hwAssetTag" required>
                </div>
                <div class="form-group">
                    <label>유형 *</label>
                    <select id="hwType" required>
                        <option value="">선택하세요</option>
                        <option value="데스크톱">데스크톱</option>
                        <option value="노트북">노트북</option>
                        <option value="모니터">모니터</option>
                        <option value="프린터">프린터</option>
                        <option value="네트워크장비">네트워크장비</option>
                        <option value="서버">서버</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>제조사</label>
                    <input type="text" id="hwManufacturer">
                </div>
                <div class="form-group">
                    <label>모델명</label>
                    <input type="text" id="hwModel">
                </div>
                <div class="form-group">
                    <label>시리얼번호</label>
                    <input type="text" id="hwSerial">
                </div>
                <div class="form-group">
                    <label>구입일</label>
                    <input type="date" id="hwPurchaseDate">
                </div>
                <div class="form-group">
                    <label>구입가격</label>
                    <input type="number" id="hwPrice">
                </div>
                <div class="form-group">
                    <label>상태</label>
                    <select id="hwStatus">
                        <option value="대기중">대기중</option>
                        <option value="사용중">사용중</option>
                        <option value="수리중">수리중</option>
                        <option value="폐기">폐기</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>비고</label>
                    <textarea id="hwNotes"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('hardwareModal')">취소</button>
                    <button type="submit" class="btn btn-primary">저장</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 소프트웨어 모달 -->
    <div id="softwareModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>소프트웨어 정보</h3>
                <span class="close" onclick="closeModal('softwareModal')">&times;</span>
            </div>
            <form id="softwareForm">
                <div class="form-group">
                    <label>소프트웨어명 *</label>
                    <input type="text" id="swName" required>
                </div>
                <div class="form-group">
                    <label>제조사</label>
                    <input type="text" id="swManufacturer">
                </div>
                <div class="form-group">
                    <label>버전</label>
                    <input type="text" id="swVersion">
                </div>
                <div class="form-group">
                    <label>유형 *</label>
                    <select id="swType" required>
                        <option value="">선택하세요</option>
                        <option value="운영체제">운영체제</option>
                        <option value="오피스">오피스</option>
                        <option value="개발도구">개발도구</option>
                        <option value="보안">보안</option>
                        <option value="기타">기타</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>라이선스 유형</label>
                    <select id="swLicenseType">
                        <option value="단일사용자">단일사용자</option>
                        <option value="다중사용자">다중사용자</option>
                        <option value="사이트라이선스">사이트라이선스</option>
                        <option value="무료">무료</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>총 라이선스 수</label>
                    <input type="number" id="swTotalLicenses" value="1">
                </div>
                <div class="form-group">
                    <label>구입일</label>
                    <input type="date" id="swPurchaseDate">
                </div>
                <div class="form-group">
                    <label>만료일</label>
                    <input type="date" id="swExpiryDate">
                </div>
                <div class="form-group">
                    <label>구입가격</label>
                    <input type="number" id="swPrice">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('softwareModal')">취소</button>
                    <button type="submit" class="btn btn-primary">저장</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 자산 할당 모달 -->
    <div id="assignmentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>자산 할당</h3>
                <span class="close" onclick="closeModal('assignmentModal')">&times;</span>
            </div>
            <form id="assignmentForm">
                <div class="form-group">
                    <label>임직원 *</label>
                    <select id="assignEmployee" required>
                        <option value="">선택하세요</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>자산 유형 *</label>
                    <select id="assetType" required onchange="updateAssetOptions()">
                        <option value="">선택하세요</option>
                        <option value="hardware">하드웨어</option>
                        <option value="software">소프트웨어</option>
                    </select>
                </div>
                <div class="form-group" id="hardwareGroup" style="display: none;">
                    <label>하드웨어 자산 *</label>
                    <select id="assignHardware">
                        <option value="">선택하세요</option>
                    </select>
                </div>
                <div class="form-group" id="softwareGroup" style="display: none;">
                    <label>소프트웨어 자산 *</label>
                    <select id="assignSoftware">
                        <option value="">선택하세요</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>할당일</label>
                    <input type="date" id="assignDate" required>
                </div>
                <div class="form-group">
                    <label>비고</label>
                    <textarea id="assignNotes"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('assignmentModal')">취소</button>
                    <button type="submit" class="btn btn-primary">할당</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 로그인 모달 -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-sign-in-alt"></i> 로그인</h3>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label>사용자명 *</label>
                    <input type="text" id="loginUsername" value="admin" required>
                    <small class="form-help">LDAP 사용자명 또는 로컬 계정</small>
                </div>
                <div class="form-group">
                    <label>비밀번호 *</label>
                    <input type="password" id="loginPassword" value="admin123" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">로그인</button>
                    <button type="button" class="btn btn-secondary" onclick="showLdapStatus()">
                        <i class="fas fa-info-circle"></i> 인증 정보
                    </button>
                </div>
            </form>
            <div id="loginError" class="alert alert-error" style="display: none;"></div>
            <div id="loginInfo" class="alert alert-info" style="display: none;"></div>
        </div>
    </div>

    <script src="script.js?v=20250808060000"></script>
</body>
</html>
